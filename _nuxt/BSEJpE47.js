import{X as Pt,h as Rt,Y as La,k as _,Z as Ua,$ as Aa,d as de,y as M,B as w,z as a,A as k,R as V,x as g,U as st,_ as ve,S as re,W as A,o as nt,L as De,a0 as ce,C as R,a1 as Pa,a2 as Ne,a3 as Z,P as Te,Q as Oe,T as J,g as o,J as Et,a4 as Nt,N as z,O as qt,a5 as Ra,D as He,a6 as Ea,M as Na,q as qa,V as Va,K as Ha}from"./DHQQY5Qe.js";import{p as K,d as Da,_ as Oa,a as Ga,b as Fa,c as Wa}from"./B4on_K7-.js";import{h as ot,u as Ya,f as Xa,g as at,s as lt,_ as ja,a as Qa,b as At,c as Ka,d as Za,e as Ja,j as el,k as tl}from"./DYJwDWjl.js";const al=["top","middle","bottom"],ll=Pt({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:t=>al.includes(t)}},setup(t,{slots:i}){const s=_(()=>t.align!==void 0?{verticalAlign:t.align}:null),u=_(()=>{const l=t.outline===!0&&t.color||t.textColor;return`q-badge flex inline items-center no-wrap q-badge--${t.multiLine===!0?"multi":"single"}-line`+(t.outline===!0?" q-badge--outline":t.color!==void 0?` bg-${t.color}`:"")+(l!==void 0?` text-${l}`:"")+(t.floating===!0?" q-badge--floating":"")+(t.rounded===!0?" q-badge--rounded":"")+(t.transparent===!0?" q-badge--transparent":"")});return()=>Rt("div",{class:u.value,style:s.value,role:"status","aria-label":t.label},La(i.default,t.label!==void 0?[t.label]:[]))}}),sl='<circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="60" cy="15" r="9" fill-opacity=".3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from=".5" to=".5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',nl=Pt({name:"QSpinnerDots",props:Ua,setup(t){const{cSize:i,classes:s}=Aa(t);return()=>Rt("svg",{class:s.value,fill:"currentColor",width:i.value,height:i.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",innerHTML:sl})}}),ol={class:"timer__time"},il=de({__name:"Timer",props:{elapsedTime:{},remainingTime:{default:0},isCountdown:{type:Boolean,default:!1},timeLimit:{default:null}},setup(t){const i=t,s=_(()=>{const S=i.isCountdown?i.remainingTime:i.elapsedTime,y=Math.floor(S/60),h=S%60;return`${y.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`}),u=_(()=>!i.isCountdown||!i.timeLimit?!1:i.remainingTime<=i.timeLimit*.3&&i.remainingTime>i.timeLimit*.1),l=_(()=>!i.isCountdown||!i.timeLimit?!1:i.remainingTime<=i.timeLimit*.1);return(S,y)=>{const h=st;return g(),M("div",{class:V(["timer",{"timer--warning":u.value,"timer--danger":l.value}])},[w(h,{name:"schedule",class:"timer__icon"}),a("span",ol,k(s.value),1)],2)}}}),ul=ve(il,[["__scopeId","data-v-f420d84a"]]),rl={key:0,class:"puzzle-tile__content"},cl={key:0,class:"puzzle-tile__number"},dl=de({__name:"PuzzleTile",props:{tileValue:{},index:{},gridSize:{},isEmpty:{type:Boolean,default:!1},isMovable:{type:Boolean,default:!1},showNumber:{type:Boolean,default:!1},imageUrl:{default:""},tileSize:{default:80},isSwapMode:{type:Boolean,default:!1},isSwapSelected:{type:Boolean,default:!1}},emits:["move"],setup(t,{emit:i}){const s=t,u=i,l=_(()=>({width:`${s.tileSize}px`,height:`${s.tileSize}px`})),S=_(()=>{if(!s.imageUrl||s.isEmpty)return{};const h=Math.floor(s.tileValue/s.gridSize),$=s.tileValue%s.gridSize,P=s.tileSize*s.gridSize;return{backgroundImage:`url(${s.imageUrl})`,backgroundSize:`${P}px ${P}px`,backgroundPosition:`-${$*s.tileSize}px -${h*s.tileSize}px`,width:"100%",height:"100%"}});function y(){s.isMovable&&!s.isEmpty&&u("move",s.index)}return(h,$)=>(g(),M("div",{class:V(["puzzle-tile",{"puzzle-tile--empty":t.isEmpty,"puzzle-tile--movable":t.isMovable&&!t.isEmpty,"puzzle-tile--swap-mode":t.isSwapMode&&!t.isEmpty,"puzzle-tile--swap-selected":t.isSwapSelected}]),style:re(l.value),onClick:y},[t.isEmpty?A("",!0):(g(),M("div",rl,[a("div",{class:"puzzle-tile__image",style:re(S.value)},null,4),t.showNumber?(g(),M("div",cl,k(t.tileValue+1),1)):A("",!0)]))],6))}}),vl=ve(dl,[["__scopeId","data-v-4bac9a6d"]]),it=window.setInterval,fl={class:"puzzle-board-container"},ml={class:"board-top-left"},pl={class:"board-top-center"},gl={class:"board-top-right"},hl={class:"board-controls"},wl={class:"puzzle-preview"},_l=["src"],bl={class:"puzzle-preview__timer"},yl=de({__name:"PuzzleBoard",props:{tiles:{},gridSize:{},emptyIndex:{},imageUrl:{default:""},showPreview:{type:Boolean,default:!1},isSwapMode:{type:Boolean,default:!1},swapFirstTile:{default:null}},emits:["move","swipe","hidePreview"],setup(t,{emit:i}){const s=Et(),u=t,l=i,S=o(null),y=o(80),h=o("05:00:00");let $=null;const P=o(0),f=o(0),C=o(0);function m(n){const p=Math.floor(n/1e3),U=n%1e3;return`${String(p).padStart(2,"0")}.${String(U).padStart(3,"0")}`}function b(){h.value="05.000";let n=5e3;$=it(()=>{n-=10,n<=0?(h.value="00.000",$&&(clearInterval($),$=null)):h.value=m(n)},10)}function x(){$&&(clearInterval($),$=null)}const T=_(()=>({display:"grid",gridTemplateColumns:`repeat(${u.gridSize}, ${y.value}px)`,gridTemplateRows:`repeat(${u.gridSize}, ${y.value}px)`,gap:"4px",padding:"8px",background:s.dark.isActive?"#6f6e6ef2":"rgba(255, 253, 253, 0.95)",borderRadius:"16px",boxShadow:s.dark.isActive?"0 8px 32px rgba(0, 0, 0, 0.4)":"0 8px 32px rgba(0, 0, 0, 0.15)"}));function N(n){const p=Math.floor(n/u.gridSize),U=n%u.gridSize,O=Math.floor(u.emptyIndex/u.gridSize),X=u.emptyIndex%u.gridSize;return p===O&&Math.abs(U-X)===1||U===X&&Math.abs(p-O)===1}function L(n){l("move",n)}function q(n){const p=n.touches[0];P.value=p.clientX,f.value=p.clientY,C.value=Date.now()}function c(n){n.preventDefault()}function r(n){const p=n.changedTouches[0],U=p.clientX-P.value,O=p.clientY-f.value,X=Date.now()-C.value,le=30;if(X>300)return;const ze=Math.abs(U),fe=Math.abs(O);ze<le&&fe<le||(ze>fe?l("swipe",U>0?"right":"left"):l("swipe",O>0?"down":"up"))}function B(){l("hidePreview")}function d(){if(typeof window>"u")return;const n=Math.min(window.innerWidth-16,500),p=Math.floor((n-16-(u.gridSize-1)*4)/u.gridSize);y.value=Math.max(40,Math.min(p,120))}return nt(()=>{d(),window.addEventListener("resize",d)}),De(()=>{window.removeEventListener("resize",d),x()}),ce(()=>u.gridSize,d),ce(()=>u.showPreview,n=>{n?b():x()}),(n,p)=>{const U=vl;return g(),M("div",fl,[a("div",{ref_key:"boardRef",ref:S,class:"puzzle-board",style:re(T.value),onTouchstart:q,onTouchmove:c,onTouchend:r},[w(Pa,{name:"tile"},{default:R(()=>[(g(!0),M(Te,null,Oe(t.tiles,(O,X)=>(g(),J(U,{key:O,"tile-value":O,index:X,"grid-size":t.gridSize,"is-empty":O===t.gridSize*t.gridSize-1,"is-movable":t.isSwapMode||N(X),"is-swap-selected":t.swapFirstTile===X,"is-swap-mode":t.isSwapMode,"image-url":t.imageUrl,"tile-size":y.value,onMove:L},null,8,["tile-value","index","grid-size","is-empty","is-movable","is-swap-selected","is-swap-mode","image-url","tile-size"]))),128))]),_:1})],36),a("div",ml,[Ne(n.$slots,"top-left",{},void 0)]),a("div",pl,[Ne(n.$slots,"top-center",{},void 0)]),a("div",gl,[Ne(n.$slots,"top-right",{},void 0)]),a("div",hl,[Ne(n.$slots,"controls",{},void 0)]),w(Z,{name:"fade"},{default:R(()=>[t.showPreview?(g(),M("div",{key:0,class:"puzzle-preview-overlay",onClick:B},[a("div",wl,[a("img",{src:t.imageUrl,alt:"ì™„ì„± ì´ë¯¸ì§€"},null,8,_l),a("p",bl,k(h.value),1)])])):A("",!0)]),_:1})])}}}),Sl=ve(yl,[["__scopeId","data-v-41de3991"]]),kl={class:"result-container"},xl={class:"badge-wrapper"},Tl={class:"badge-inner"},zl={class:"result-title"},Ml={key:0,class:"stars-row"},$l={key:1,class:"new-record-badge"},Cl={class:"stats-container"},Il={class:"stat-item"},Bl={class:"stat-value"},Ll={class:"stat-item"},Ul={class:"stat-value"},Al={class:"stat-item"},Pl={class:"stat-value"},Rl={class:"actions-container"},El=de({__name:"ResultModal",props:{modelValue:{type:Boolean},isSuccess:{type:Boolean},stage:{},time:{},moves:{},hintsUsed:{},stars:{},isNewRecord:{type:Boolean,default:!1},isLastStage:{type:Boolean,default:!1},nextModeName:{default:""},isLastStageOfLastMode:{type:Boolean,default:!1}},emits:["update:modelValue","retry","nextStage","goHome"],setup(t,{emit:i}){const{t:s}=ot(),u=t,l=i,S=_({get:()=>u.modelValue,set:m=>l("update:modelValue",m)}),y=_(()=>{const m=Math.floor(u.time/60),b=u.time%60;return`${m.toString().padStart(2,"0")}:${b.toString().padStart(2,"0")}`}),h=_(()=>u.time>=600||u.moves>=100||u.hintsUsed>=10);function $(){const m=document.querySelector(".result-card");if(!m)return;const b=["#f88967","#ffb88c","#ffd4c4","#ff9a9e","#ffecd2"].map(x=>K.Color.fromHex(x));K.confetti(m,{count:K.variation.range(40,60),spread:K.variation.range(40,60),color:b}),setTimeout(()=>{K.confetti(m,{count:K.variation.range(30,50),spread:K.variation.range(30,50),color:b})},200),setTimeout(()=>{K.confetti(m,{count:K.variation.range(20,40),spread:K.variation.range(20,40),color:b})},400)}ce(S,m=>{m&&u.isSuccess&&Ra(()=>{setTimeout(()=>{$()},100)})});function P(){l("retry")}function f(){l("nextStage")}function C(){l("goHome")}return(m,b)=>{const x=st,T=qt,N=Nt;return g(),J(N,{modelValue:S.value,"onUpdate:modelValue":b[0]||(b[0]=L=>S.value=L),persistent:""},{default:R(()=>[a("div",kl,[a("div",{class:V(["result-card",{success:t.isSuccess,fail:!t.isSuccess}])},[a("div",xl,[b[1]||(b[1]=a("div",{class:"badge-rays"},null,-1)),a("div",Tl,[w(x,{name:t.isSuccess?"emoji_events":"timer_off",size:"48px"},null,8,["name"])])]),a("h2",zl,k(t.isSuccess?z(s)("resultSuccess"):z(s)("resultTimeUp")),1),t.isSuccess?(g(),M("div",Ml,[(g(),M(Te,null,Oe(3,L=>w(x,{key:L,name:L<=t.stars?"star":"star_border",class:V({"star-active":L<=t.stars}),size:"44px"},null,8,["name","class"])),64))])):A("",!0),t.isNewRecord?(g(),M("div",$l,k(z(s)("newRecord")),1)):A("",!0),a("div",Cl,[a("div",{class:V(["stat-row",{compact:h.value}])},[a("div",Il,[w(x,{name:"timer",size:"20px"}),a("span",Bl,k(y.value),1)]),b[2]||(b[2]=a("div",{class:"stat-divider"},null,-1)),a("div",Ll,[w(x,{name:"touch_app",size:"20px"}),a("span",Ul,k(t.moves),1)]),b[3]||(b[3]=a("div",{class:"stat-divider"},null,-1)),a("div",Al,[w(x,{name:"image",size:"20px"}),a("span",Pl,k(t.hintsUsed),1)])],2)]),a("div",Rl,[w(T,{flat:"",class:"action-btn secondary",icon:"home",label:z(s)("home"),onClick:C},null,8,["label"]),w(T,{flat:"",class:"action-btn secondary",icon:"replay",label:z(s)("retry"),onClick:P},null,8,["label"]),t.isSuccess&&!t.isLastStageOfLastMode?(g(),J(T,{key:0,unelevated:"",class:"action-btn primary",icon:t.isLastStage?"emoji_events":"arrow_forward",label:t.isLastStage?t.nextModeName:z(s)("next"),onClick:f},null,8,["icon","label"])):A("",!0)])],2)])]),_:1},8,["modelValue"])}}}),Nl=ve(El,[["__scopeId","data-v-c2dea8f0"]]),ql={class:"demo-tile__number"},ae=3,Y=70,qe=4,Ve=8,Vl=de({__name:"TutorialOverlay",props:{imageUrl:{}},emits:["close"],setup(t){const i=t,{t:s}=ot(),u=[0,1,2,3,4,5,6,7,8],l=[5,4,1,0,3],S=[0,1,4,5,8],y=[0,1,2,3,4,5,6,7,8],h=o("complete"),$=o([...y]),P=o(null),f=o(!1);let C=[];function m(d){return new Promise(n=>{const p=setTimeout(n,d);C.push(p)})}function b(){C.forEach(d=>clearTimeout(d)),C=[]}const x=_(()=>{switch(h.value){case"complete":return s("tutorialGoal");case"shuffling":return s("tutorialScrambled");case"solving":return s("tutorialText");case"celebration":return s("tutorialComplete");default:return""}});function T(d){return $.value.indexOf(d)}function N(d){const n=T(d),p=Math.floor(n/ae),U=n%ae;return{width:`${Y}px`,height:`${Y}px`,position:"absolute",left:`${U*(Y+qe)}px`,top:`${p*(Y+qe)}px`}}function L(d){const n=Math.floor(d/ae),p=d%ae,U=Y*ae;return{backgroundImage:`url(${i.imageUrl})`,backgroundSize:`${U}px ${U}px`,backgroundPosition:`-${p*Y}px -${n*Y}px`}}const q=_(()=>{if(P.value===null)return{display:"none"};const d=Math.floor(P.value/ae),p=P.value%ae*(Y+qe)+Y/2,U=d*(Y+qe)+Y+12;return{left:`${p}px`,top:`${U}px`}});function c(d){const n=[...$.value],p=n.indexOf(Ve);n[p]=n[d],n[d]=Ve,$.value=n}let r=!1;async function B(){for(r=!1;!r&&(h.value="complete",$.value=[...y],f.value=!1,await m(2e3),!(r||(h.value="shuffling",await m(400),r)));){for(const d of l){if(r)break;c(d),await m(350)}if(r||(await m(600),r)||(h.value="solving",f.value=!0,await m(300),r))break;for(const d of S)if(r||(P.value=d,await m(600),r)||(c(d),await m(500),r))break;if(f.value=!1,await m(300),r)break;h.value="celebration",await m(2e3)}}return nt(()=>{B()}),De(()=>{r=!0,b()}),(d,n)=>(g(),M("div",{class:"tutorial-overlay",onClick:n[2]||(n[2]=p=>d.$emit("close"))},[a("div",{class:"tutorial-content",onClick:n[1]||(n[1]=Ea(()=>{},["stop"]))},[w(Z,{name:"text-fade",mode:"out-in"},{default:R(()=>[(g(),M("p",{class:"tutorial-status-text",key:x.value},k(x.value),1))]),_:1}),a("div",{class:V(["demo-board",{"demo-board--celebrate":h.value==="celebration"}])},[(g(),M(Te,null,Oe(u,p=>a("div",{key:p,class:V(["demo-tile",{"demo-tile--empty":p===Ve}]),style:re(N(p))},[p!==Ve?(g(),M(Te,{key:0},[a("div",{class:"demo-tile__image",style:re(L(p))},null,4),a("div",ql,k(p+1),1)],64)):A("",!0)],6)),64)),w(Z,{name:"finger-fade"},{default:R(()=>[f.value?(g(),M("div",{key:0,class:"demo-finger",style:re(q.value)},[...n[3]||(n[3]=[a("span",{class:"finger-ripple"},null,-1),He(" ðŸ‘† ",-1)])],4)):A("",!0)]),_:1})],2),a("p",{class:"tutorial-skip",onClick:n[0]||(n[0]=p=>d.$emit("close"))},k(z(s)("tutorialStart")),1)])]))}}),Hl=ve(Vl,[["__scopeId","data-v-d1cbe442"]]);function Dl(t=3){const i=o(t),s=_(()=>i.value*i.value),u=o([]),l=o(s.value-1),S=o(0),y=o(!1),h=o([]);function $(){u.value=Array.from({length:s.value},(c,r)=>r),l.value=s.value-1,S.value=0,y.value=!1,h.value=[]}function P(c=100){$();let r=-1;for(let B=0;B<c;B++){const d=f().filter(n=>n!==r);if(d.length>0){const n=d[Math.floor(Math.random()*d.length)];r=l.value,m(n)}}S.value=0,h.value=[],y.value=!1}function f(){const c=[],r=Math.floor(l.value/i.value),B=l.value%i.value;return r>0&&c.push(l.value-i.value),r<i.value-1&&c.push(l.value+i.value),B>0&&c.push(l.value-1),B<i.value-1&&c.push(l.value+1),c}function C(c){return f().includes(c)}function m(c){if(!C(c))return!1;const r=u.value[c];return u.value[c]=u.value[l.value],u.value[l.value]=r,l.value=c,!0}function b(c){if(y.value||!C(c))return!1;const r=c,B=l.value;return m(c),S.value++,h.value.push({from:r,to:B}),T(),!0}function x(c){const r=Math.floor(l.value/i.value),B=l.value%i.value;let d=-1;switch(c){case"up":r<i.value-1&&(d=l.value+i.value);break;case"down":r>0&&(d=l.value-i.value);break;case"left":B<i.value-1&&(d=l.value+1);break;case"right":B>0&&(d=l.value-1);break}return d!==-1?b(d):!1}function T(){const c=u.value.every((r,B)=>r===B);return y.value=c,c}function N(){return Array.from({length:s.value},(c,r)=>r)}function L(c){i.value=c,$()}function q(c,r){if(c===l.value||r===l.value||c<0||c>=s.value||r<0||r>=s.value)return!1;const B=u.value[c];return u.value[c]=u.value[r],u.value[r]=B,T(),!0}return{tiles:u,emptyIndex:l,moves:S,isSolved:y,gridSize:i,totalTiles:s,moveHistory:h,initPuzzle:$,shufflePuzzle:P,moveTile:b,moveByDirection:x,canMoveTile:C,getMovableTiles:f,getSolvedState:N,setGridSize:L,checkSolved:T,swapTiles:q}}function Ol(t=null){const i=o(0),s=o(t||0),u=o(!1),l=o(t!==null),S=o(t),y=o(!1);let h=null;const $=_(()=>f(i.value)),P=_(()=>f(s.value));function f(T){const N=Math.floor(T/60),L=T%60;return`${N.toString().padStart(2,"0")}:${L.toString().padStart(2,"0")}`}function C(){u.value||(u.value=!0,y.value=!1,h=it(()=>{i.value++,l.value&&S.value!==null&&(s.value=Math.max(0,S.value-i.value),s.value<=0&&(y.value=!0,m()))},1e3))}function m(){u.value=!1,h&&(clearInterval(h),h=null)}function b(T=null){m(),i.value=0,y.value=!1,T!==null?(S.value=T,s.value=T,l.value=!0):S.value!==null&&(s.value=S.value)}function x(T){S.value=T,l.value=T!==null,T!==null&&(s.value=T)}return De(()=>{m()}),{elapsedTime:i,remainingTime:s,isRunning:u,isCountdown:l,isTimeUp:y,timeLimit:S,formattedElapsed:$,formattedRemaining:P,start:C,stop:m,reset:b,setTimeLimit:x,formatTime:f}}const Gl={class:"game-page"},Fl={class:"title-bar"},Wl={class:"app-title"},Yl={class:"title-actions"},Xl={class:"stage-header"},jl={class:"stage-info"},Ql={class:"game-board-wrapper"},Kl={class:"status-item"},Zl={key:0,class:"grid-size-selector"},Jl=["onClick"],es={key:0,class:"swap-toast"},ts={key:0,class:"swap-button-wrapper"},as={class:"arcade-dialog"},ls={class:"arcade-dialog-inner"},ss={class:"arcade-icon-wrapper"},ns={class:"arcade-icon"},os={class:"arcade-title"},is=["innerHTML"],us={class:"arcade-buttons"},rs={key:0,class:"ad-loading-overlay"},cs={key:0,class:"countdown-overlay"},ds={class:"card-container"},vs={key:0,class:"speech-bubble"},fs={class:"card-front"},ms=["src"],ps={key:1,class:"countdown-text"},gs=de({__name:"[stage]",setup(t){const i=Et(),s=Va(),u=Ha(),{t:l,initLocale:S,getDifficultyName:y,getModeDesc:h}=ot(),$=_(()=>i.dark.isActive);function P(){i.dark.toggle(),localStorage.setItem("slidingPuzzle-dark-mode",String(i.dark.isActive))}const f=_(()=>s.params.difficulty||"easy"),C=_(()=>Number(s.params.stage)||1),m=_(()=>el(f.value)),b=o(3),x=_(()=>m.value.gridSize===0?b.value||3:m.value.gridSize),T=_(()=>f.value==="free");function N(e){if(e==="easy"||oe.value.includes(e))return!0;const v=bt[e];if(!v)return!1;const I=Se.value[v.prevId]||0,E=le(v.prevId),D=Math.round(I*v.percent/100);return E.cleared>=D&&I>0}const L=_(()=>{const e=[3];return N("normal")&&e.push(4),N("hard")&&e.push(5),N("expert")&&e.push(6),e}),q=_(()=>m.value.timeLimit),c=_(()=>q.value!==null),r=_(()=>({easy:3,normal:4,hard:5,expert:6,free:4})[f.value]||3);function B(e){L.value.includes(e)&&b.value!==e&&(b.value=e,tt(!0))}const n=qa().app.baseURL||"",p=_(()=>tl(f.value,C.value,n)),{progress:U,initProgress:O,clearStage:X,getDifficultyProgress:le}=Ya(),{playMove:Ge,playClear:ze,playHint:fe,playReload:Vt,playBeep:ut,playGo:Ht,loadSounds:Dt,setMuted:rt,playGameBgm:Fe,stopBgm:ct}=Xa(),j=o(!0),ee=o(!1),We=o(!1),dt=o(0),vt=o(!1),te=o(0),me=o(0),G=o(0),H=o(!1),F=o(null),Ye=o(!1),Xe=_(()=>!0),ft=_(()=>f.value==="expert"?2:(f.value==="hard",1)),mt=_(()=>C.value>=Ue.value),Ot=_(()=>{const e=["easy","normal","hard","expert","free"],v=e.indexOf(f.value);if(v<e.length-1){const I=e[v+1];return y(I)}return""}),Gt=_(()=>f.value==="free"?!1:!!(f.value==="expert"&&mt.value)),pe=o(!1),ge=o(!1),Me=o(!1),$e=o(!1);let Ce=null,Ie=null,Be=[],se=null;function pt(){Xe.value&&(pe.value=!0)}function Ft(){G.value>0||H.value?wa():pt()}function Wt(){gt(),pt()}function je(){he();const e=$e.value?300*1e3:180*1e3;Ce=setTimeout(()=>{G.value<=0&&Xe.value&&!kt.value&&(Me.value=!0,Ie=setTimeout(()=>{Me.value=!1,je()},4500))},e)}function gt(){Me.value=!1,he()}function he(){Ce&&(clearTimeout(Ce),Ce=null),Ie&&(clearTimeout(Ie),Ie=null)}let Le=null,we=!1;function Yt(){window.onRewardedAdResult=e=>{we||(we=!0,Le&&(clearTimeout(Le),Le=null),ge.value=!1,ht(e))}}function Xt(){Le=setTimeout(()=>{ge.value&&!we&&(we=!0,ge.value=!1,ht(!1))},6e4);try{const e=window.Android;if(e){e.showRewardedAd();return}}catch(e){console.log("Android interface not available:",e)}setTimeout(()=>{window.onRewardedAdResult(!0)},2e3)}function jt(){ge.value=!0,pe.value=!1,we=!1,Xt()}function ht(e){e?(G.value++,$e.value=!0,i.notify({message:l("swapHintAdded"),color:"dark",position:"bottom",timeout:2e3,icon:"swap_horiz",classes:"toast-dark"})):(i.notify({message:l("adNotCompleted"),color:"dark",position:"bottom",timeout:2e3,icon:"info",classes:"toast-dark"}),je())}function Qt(){pe.value=!1}const ne=o(!1),Ue=o(0),Qe=o(!1),Ke=o(!1),_e=o(!1),be=o(!1),ye=o(""),wt=o(""),_t=o(""),Se=o({}),bt={normal:{prevId:"easy",percent:50},hard:{prevId:"normal",percent:60},expert:{prevId:"hard",percent:70}};async function Kt(){try{const e=await $fetch(`${n}stages.json`);Se.value=e,Ue.value=e[f.value]||0}catch(e){console.error("Failed to fetch stage counts:",e)}}const oe=o([]),ke=o([]),Ze=o(!1);async function Zt(){const e=await at("unlockedModes");oe.value=e||[]}async function Jt(e){oe.value.includes(e)||(oe.value.push(e),await lt("unlockedModes",[...oe.value]))}async function ea(){const e=await at("unlockSeen");ke.value=e||[]}async function ta(){const e=await at("tutorialSeen");Ze.value=e||!1}async function aa(e){if(e==="easy"||oe.value.includes(e))return!0;let v=!1;if(e==="free"){const I=Se.value.easy||0;v=le("easy").cleared>=I&&I>0}else{const I=bt[e];if(I){const E=Se.value[I.prevId]||0,D=le(I.prevId),Ee=Math.round(E*I.percent/100);v=D.cleared>=Ee&&E>0}}return v&&await Jt(e),v}function la(e){return ke.value.includes(e)}async function yt(e){ke.value.includes(e)||(ke.value.push(e),await lt("unlockSeen",[...ke.value]))}async function sa(){if(Object.keys(Se.value).length===0)return null;const e=["easy","normal","hard","expert","free"],I=e.indexOf(f.value)+1;if(I>=e.length)return null;const E=e[I];return await aa(E)&&!la(E)?{id:E,nameKr:y(E),desc:h(E)}:null}const na=Dl(x.value),{tiles:oa,emptyIndex:St,moves:Je,isSolved:kt,shufflePuzzle:xt,moveTile:ia,moveByDirection:ua,setGridSize:Tt,swapTiles:ra}=na,ca=Ol(q.value),{elapsedTime:Ae,remainingTime:da,start:Pe,stop:zt,reset:Mt,setTimeLimit:$t}=ca;ce(kt,e=>{e&&Ct()}),ce(G,(e,v)=>{e===0&&v>0?je():e>0&&gt()});function et(){Q.value&&(ye.value=Q.value.id,wt.value=Q.value.nameKr,_t.value=Q.value.desc,be.value=!0)}const ie=o(null);function va(e){if(H.value){_a(e);return}ia(e)&&Ge()}function fa(e){ua(e)&&Ge()}const Q=o(null);async function Ct(){zt(),ze(),We.value=!0;const e=X(f.value,C.value,Ae.value,Je.value,me.value);dt.value=e.stars,vt.value=e.isNewRecord,Q.value=await sa(),ee.value=!0}async function ma(){be.value=!1,ye.value&&await yt(ye.value),Q.value=null;const e=ie.value;ie.value=null,setTimeout(()=>{if(e==="next"){const v=C.value+1;v<=Ue.value?u.push(`/game/${f.value}/${v}`):u.push("/")}else e==="home"?u.push("/"):e==="retry"&&It()},100)}async function pa(){be.value=!1;const e=ye.value;e&&await yt(e),Q.value=null,ie.value=null,setTimeout(()=>{u.push("/")},100)}function ga(){te.value<=0||(fe(),te.value--,me.value++,setTimeout(()=>{ne.value=!0,setTimeout(()=>{ne.value=!1},5e3)},100))}function ha(){ne.value=!1}function wa(){if(!(G.value<=0)){if(H.value){ba();return}H.value=!0,F.value=null,Ye.value=!0,setTimeout(()=>{Ye.value=!1},2500)}}function _a(e){return!H.value||e===St.value?!1:F.value===null?(F.value=e,!0):F.value===e?(F.value=null,!0):(ra(F.value,e),G.value--,H.value=!1,F.value=null,fe(),!0)}function ba(){H.value=!1,F.value=null}function It(){Vt(),ee.value=!1,te.value=r.value,me.value=0,ne.value=!1,G.value=ft.value,H.value=!1,F.value=null,$e.value=!1,he(),Tt(x.value),xt(x.value*x.value*10),$t(q.value),Mt(q.value),Pe()}function Bt(){Q.value&&We.value?(ie.value="retry",ee.value=!1,setTimeout(()=>et(),300)):It()}function Lt(){zt(),Q.value?(ie.value="home",ee.value=!1,setTimeout(()=>et(),300)):u.push("/")}function ya(){if(Q.value)ie.value="next",ee.value=!1,setTimeout(()=>et(),300);else{const e=C.value+1;if(e<=Ue.value)u.push(`/game/${f.value}/${e}`);else{const v=["easy","normal","hard","expert","free"],I=v.indexOf(f.value);if(I<v.length-1){const E=v[I+1];u.push(`/game/${E}/1`)}else u.push("/")}}}function Sa(){j.value=!j.value,rt(!j.value),U.value.soundEnabled=j.value,j.value?Fe():ct()}const ue=o(""),xe=o(!1),Re=o(0);async function ka(){Ke.value=!1,Ze.value=!0,await lt("tutorialSeen",!0),_e.value=!0,Pe(),j.value&&Fe()}function xa(){Re.value++,Re.value>=20&&(Re.value=0,Ct())}function Ut(){Be.forEach(e=>clearTimeout(e)),Be=[],se&&(clearInterval(se),se=null)}function Ta(){Ut(),Qe.value=!0,ue.value="",xe.value=!1,_e.value=!1,Be.push(setTimeout(()=>{xe.value=!0,Be.push(setTimeout(()=>{ue.value="3",ut(700,150);let e=3;se=it(()=>{e--,e>0?(ue.value=String(e),ut(700,150)):e===0?(ue.value="GO!",Ht()):(clearInterval(se),se=null,Qe.value=!1,Ze.value?(_e.value=!0,Pe(),j.value&&Fe()):Ke.value=!0)},1e3)},600))},3e3))}function tt(e=!1){m.value.gridSize===0&&(L.value.includes(b.value)||(b.value=L.value[L.value.length-1]||3)),te.value=r.value,me.value=0,ne.value=!1,G.value=ft.value,H.value=!1,F.value=null,$e.value=!1,he(),_e.value=!1,Re.value=0,Tt(x.value),xt(x.value*x.value*10),$t(q.value),Mt(q.value),e?(_e.value=!0,Pe()):Ta()}return nt(async()=>{S(),Yt(),await O(),await Promise.all([Zt(),ea(),ta()]),await Kt(),Dt(),j.value=U.value.soundEnabled,rt(!j.value),tt()}),De(()=>{ct(),he(),Ut()}),ce([f,C],()=>{tt()}),(e,v)=>{const I=qt,E=ul,D=st,Ee=ll,za=Sl,Ma=Nl,$a=Da,Ca=Nt,Ia=nl,Ba=Hl;return g(),M("div",Gl,[v[6]||(v[6]=Na('<div class="bg-decorations" data-v-505afbc2><img src="'+ja+'" class="bg-icon" style="bottom:2%;left:2%;width:120px;animation-delay:0s;" data-v-505afbc2><img src="'+Qa+'" class="bg-icon" style="top:8%;right:5%;width:80px;animation-delay:1.5s;" data-v-505afbc2><img src="'+At+'" class="bg-icon" style="top:12%;right:19%;width:55px;animation-delay:0.3s;" data-v-505afbc2><img src="'+At+'" class="bg-icon" style="top:19%;right:50%;width:44px;animation-delay:0.3s;" data-v-505afbc2><img src="'+Ka+'" class="bg-icon" style="top:5%;left:22%;width:60px;animation-delay:0.8s;" data-v-505afbc2><img src="'+Za+'" class="bg-icon" style="top:9%;left:2%;width:120px;animation-delay:1.2s;" data-v-505afbc2><img src="'+Oa+'" class="bg-icon" style="bottom:20%;right:15%;width:32px;animation-delay:1.3s;" data-v-505afbc2><img src="'+Ga+'" class="bg-icon" style="bottom:10%;left:8%;width:24px;animation-delay:0.3s;" data-v-505afbc2><img src="'+Ja+'" class="bg-icon" style="bottom:12%;right:24%;width:38px;animation-delay:1.3s;" data-v-505afbc2><img src="'+Fa+'" class="bg-icon" style="bottom:22%;left:32%;width:42px;animation-delay:0.3s;" data-v-505afbc2><img src="'+Wa+'" class="bg-icon" style="bottom:8%;right:2%;width:18px;animation-delay:2.1s;" data-v-505afbc2></div>',1)),a("header",Fl,[w(I,{flat:"",round:"",size:"md",icon:"arrow_back",color:"white",onClick:Lt}),a("span",Wl,k(z(l)("appTitle")),1),a("div",Yl,[w(I,{flat:"",round:"",size:"md",color:"white",icon:$.value?"light_mode":"dark_mode",onClick:P},null,8,["icon"]),w(I,{flat:"",round:"",size:"md",color:"white",icon:j.value?"volume_up":"volume_off",onClick:Sa},null,8,["icon"])])]),a("div",Xl,[a("div",jl,[a("div",{class:V(["difficulty-badge",f.value])},k(z(y)(f.value)),3),a("div",{class:"stage-badge",onClick:xa},k(T.value?"FREE":"STAGE")+" "+k(String(C.value).padStart(2,"0")),1)]),c.value?(g(),J(E,{key:0,"elapsed-time":z(Ae),"remaining-time":z(da),"is-countdown":!0,"time-limit":q.value},null,8,["elapsed-time","remaining-time","time-limit"])):(g(),J(E,{key:1,"elapsed-time":z(Ae)},null,8,["elapsed-time"]))]),a("div",Ql,[w(za,{tiles:z(oa),"grid-size":x.value,"empty-index":z(St),"image-url":p.value,"show-preview":ne.value,"is-swap-mode":H.value,"swap-first-tile":F.value,onMove:va,onSwipe:fa,onHidePreview:ha},{"top-left":R(()=>[a("div",Kl,[a("span",null,k(z(l)("moves",{count:z(Je)})),1)])]),"top-right":R(()=>[T.value?(g(),M("div",Zl,[(g(!0),M(Te,null,Oe(L.value,W=>(g(),M("button",{key:W,class:V(["grid-size-btn",{active:b.value===W}]),onClick:hs=>B(W)},k(W)+"x"+k(W),11,Jl))),128))])):A("",!0)]),"top-center":R(()=>[w(Z,{name:"swap-toast"},{default:R(()=>[Ye.value?(g(),M("div",es,[w(D,{name:"swap_horiz",size:"20px"}),a("span",null,k(z(l)("selectTwoTiles")),1)])):A("",!0)]),_:1})]),controls:R(()=>[a("div",{class:"control-button",onClick:Bt},[w(D,{name:"refresh",size:"24px"})]),a("div",{class:"control-button",onClick:ga},[w(D,{name:"image",size:"24px",class:V({disabled:te.value<=0})},null,8,["class"]),te.value>0?(g(),J(Ee,{key:0,floating:"",rounded:"",class:"control-badge"},{default:R(()=>[He(k(te.value),1)]),_:1})):A("",!0)]),Xe.value?(g(),M("div",ts,[a("div",{class:V(["control-button",{active:H.value}]),onClick:Ft},[w(D,{name:"swap_horiz",size:"24px",class:V({disabled:G.value<=0&&!H.value})},null,8,["class"]),G.value>0?(g(),J(Ee,{key:0,floating:"",rounded:"",class:"control-badge swap-badge"},{default:R(()=>[He(k(G.value),1)]),_:1})):A("",!0)],2),w(Z,{name:"ad-bubble"},{default:R(()=>[Me.value?(g(),M("div",{key:0,class:"ad-hint-bubble",onClick:Wt},[w(D,{name:"play_circle",size:"16px"}),a("span",null,k(z(l)("watchAdForHint")),1)])):A("",!0)]),_:1})])):A("",!0)]),_:1},8,["tiles","grid-size","empty-index","image-url","show-preview","is-swap-mode","swap-first-tile"])]),w(Ma,{modelValue:ee.value,"onUpdate:modelValue":v[0]||(v[0]=W=>ee.value=W),"is-success":We.value,stage:C.value,time:z(Ae),moves:z(Je),"hints-used":me.value,stars:dt.value,"is-new-record":vt.value,"is-last-stage":mt.value,"next-mode-name":Ot.value,"is-last-stage-of-last-mode":Gt.value,onRetry:Bt,onNextStage:ya,onGoHome:Lt},null,8,["modelValue","is-success","stage","time","moves","hints-used","stars","is-new-record","is-last-stage","next-mode-name","is-last-stage-of-last-mode"]),w($a,{modelValue:be.value,"onUpdate:modelValue":v[1]||(v[1]=W=>be.value=W),difficulty:ye.value,"mode-name":wt.value,"mode-desc":_t.value,onClose:ma,onGoHome:pa},null,8,["modelValue","difficulty","mode-name","mode-desc"]),w(Ca,{modelValue:pe.value,"onUpdate:modelValue":v[2]||(v[2]=W=>pe.value=W),persistent:""},{default:R(()=>[a("div",as,[a("div",ls,[a("div",ss,[v[3]||(v[3]=a("div",{class:"arcade-icon-glow"},null,-1)),a("div",ns,[w(D,{name:"swap_horiz",size:"40px"})]),v[4]||(v[4]=a("div",{class:"arcade-plus"},"+1",-1))]),a("h3",os,k(z(l)("swapHint")),1),a("p",{class:"arcade-desc",innerHTML:z(l)("getHintWithAd").replace("\\n","<br />")},null,8,is),a("div",us,[a("button",{class:"arcade-btn arcade-btn-cancel",onClick:Qt},k(z(l)("cancel")),1),a("button",{class:"arcade-btn arcade-btn-watch",onClick:jt},[w(D,{name:"play_arrow",size:"20px"}),He(" "+k(z(l)("watchAd")),1)])])])])]),_:1},8,["modelValue"]),w(Z,{name:"fade"},{default:R(()=>[ge.value?(g(),M("div",rs,[w(Ia,{color:"white",size:"60px"}),a("p",null,k(z(l)("adLoading")),1)])):A("",!0)]),_:1}),w(Z,{name:"fade"},{default:R(()=>[Ke.value?(g(),J(Ba,{key:0,"image-url":p.value,onClose:ka},null,8,["image-url"])):A("",!0)]),_:1}),w(Z,{name:"fade"},{default:R(()=>[Qe.value?(g(),M("div",cs,[a("div",ds,[xe.value?A("",!0):(g(),M("div",vs,k(z(l)("rememberImage")),1)),a("div",{class:V(["card",{flipped:xe.value}])},[a("div",fs,[a("img",{src:p.value,class:"countdown-image",alt:"Puzzle image"},null,8,ms)]),v[5]||(v[5]=a("div",{class:"card-back"},[a("div",{class:"card-back-pattern"}),a("div",{class:"card-back-dim"})],-1))],2),xe.value&&ue.value?(g(),M("div",ps,k(ue.value),1)):A("",!0)])])):A("",!0)]),_:1})])}}}),ys=ve(gs,[["__scopeId","data-v-505afbc2"]]);export{ys as default};
