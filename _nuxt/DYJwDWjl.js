import{k as R,g as D,a7 as M,a0 as G,q as V}from"./DHQQY5Qe.js";function Q(){if(typeof window>"u")return"en";const a=new URLSearchParams(window.location.search).get("lang");return a==="en"||a==="ko"?a:(navigator.language||navigator.userLanguage||"").toLowerCase().startsWith("ko")?"ko":"en"}const _=D("en");let j=!1;const $={ko:{appTitle:"í¼ì¦íŒ¡",home:"í™ˆ",retry:"ë‹¤ì‹œ",next:"ë‹¤ìŒ",continue:"ê³„ì†",confirm:"í™•ì¸",notice:"ì•Œë¦¼",cancel:"ê´œì°®ì•„ìš”",difficulty:{easy:"ì‰¬ì›€",normal:"ë³´í†µ",hard:"ì–´ë ¤ì›€",expert:"ì „ë¬¸ê°€",free:"ìžìœ "},mastered:"ë§ˆìŠ¤í„°!",locked:"ìž ê¹€",stage:"ë‹¨ê³„",stageFormat:"{stage}ë‹¨ê³„ ({percent}%)",unlockAllModes:"ëª¨ë“  ëª¨ë“œë¥¼ í´ë¦¬ì–´í•´ì£¼ì„¸ìš” ðŸ˜Š",unlockRequirement:"{mode} ëª¨ë“œ {stage}ë‹¨ê³„ê¹Œì§€ í´ë¦¬ì–´í•´ì£¼ì„¸ìš” ðŸ˜Š",unlockFreeMode:"ì‰¬ì›€ ëª¨ë“œë¥¼ ëª¨ë‘ í´ë¦¬ì–´í•´ì£¼ì„¸ìš” ðŸ˜Š",moves:"{count}íšŒ ì´ë™",selectTwoTiles:"ë°”ê¿€ íƒ€ì¼ 2ê°œë¥¼ ì„ íƒí•˜ì„¸ìš”!",swapHint:"ìœ„ì¹˜ ë°”ê¾¸ê¸°",watchAdForHint:"ê´‘ê³  ì‹œì²­í•˜ê³  ížŒíŠ¸ë¥¼ ë°›ì„ ìˆ˜ ìžˆì–´ìš”!",watchAd:"ê´‘ê³  ë³´ê¸°",adLoading:"ê´‘ê³  ë¡œë”© ì¤‘...",swapHintAdded:"ìœ„ì¹˜ ë°”ê¾¸ê¸° ížŒíŠ¸ê°€ ì¶”ê°€ë˜ì—ˆì–´ìš”!",adNotCompleted:"ê´‘ê³  ì‹œì²­ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.",getHintWithAd:`ê´‘ê³ ë¥¼ ì‹œì²­í•˜ê³ 
ížŒíŠ¸ 1íšŒë¥¼ ë°›ìœ¼ì„¸ìš”!`,hintCount:"ížŒíŠ¸ 1íšŒ",rememberImage:"ì´ë¯¸ì§€ë¥¼ ìž˜ ê¸°ì–µí•˜ì„¸ìš” :)",tutorialText:"íƒ€ì¼ì„ í„°ì¹˜í•˜ë©´ ë¹ˆ ê³µê°„ìœ¼ë¡œ ì´ë™ë¼ìš”.",tutorialStart:"í™”ë©´ì„ í„°ì¹˜í•´ì„œ ê²Œìž„ì„ ì‹œìž‘í•˜ì„¸ìš” :)",tutorialGoal:"íƒ€ì¼ì„ ì›€ì§ì—¬ì„œ ê·¸ë¦¼ì„ ì™„ì„±í•˜ì„¸ìš”!",tutorialScrambled:"ìš”ë¦¬ì¡°ë¦¬ ê³¨ê³ ë£¨ ì„žì´ëŠ” íƒ€ì¼ë“¤ðŸ˜­",tutorialComplete:"ê·¸ë¦¼ì„ ì™„ì„±í•˜ë©´ CLEAR!!ðŸ¥³",resultSuccess:"ìš°ì™€! ëŒ€ë‹¨í•´ìš” ðŸ‘",resultTimeUp:"ì‹œê°„ ì´ˆê³¼ â°",newRecord:"ì‹ ê¸°ë¡ ë‹¬ì„±!",modeUnlocked:"{mode}ëª¨ë“œ ìž ê¸ˆ í•´ì œ!",newChallenge:"ìƒˆë¡œìš´ ë„ì „ì´ ê¸°ë‹¤ë¦¬ê³  ìžˆì–´ìš”!",modeDesc:{normal:"4x4 í¼ì¦ì— ë„ì „í•´ë³´ì„¸ìš”!",hard:"5x5 í¼ì¦ì— ë„ì „í•´ë³´ì„¸ìš”!",expert:"6x6 í¼ì¦ì˜ ê·¹í•œ ë„ì „!",free:"í´ë¦¬ì–´í•œ ëª¨ë“œë¥¼ ìžìœ ë¡­ê²Œ ì¦ê¸¸ ìˆ˜ ìžˆì–´ìš”."},copyright:"Â© 2026 Mangosoft Lab."},en:{appTitle:"PuzzlePang",home:"Home",retry:"Retry",next:"Next",continue:"Go",confirm:"OK",notice:"Notice",cancel:"No thanks",difficulty:{easy:"Easy",normal:"Normal",hard:"Hard",expert:"Expert",free:"Free"},mastered:"Master!",locked:"Locked",stage:"Stage",stageFormat:"Lv.{stage} ({percent}%)",unlockAllModes:"Clear all modes first ðŸ˜Š",unlockRequirement:"Clear {mode} Lv.{stage} first ðŸ˜Š",unlockFreeMode:"Clear all Easy stages first ðŸ˜Š",moves:"{count} moves",selectTwoTiles:"Pick 2 tiles to swap!",swapHint:"Swap",watchAdForHint:"Watch ad for a free hint!",watchAd:"Watch",adLoading:"Loading ad...",swapHintAdded:"Swap hint added!",adNotCompleted:"Ad was not completed.",getHintWithAd:`Watch an ad to get
1 free hint!`,hintCount:"1 Hint",rememberImage:"Memorize this image :)",tutorialText:"Tap a tile to slide it!",tutorialStart:"Tap to start the game :)",tutorialGoal:"Slide tiles to complete the image!",tutorialScrambled:"Tiles are shuffled...",tutorialComplete:"Puzzle complete!",resultSuccess:"Well done! ðŸ‘",resultTimeUp:"Time's up â°",newRecord:"New Record!",modeUnlocked:"{mode} Unlocked!",newChallenge:"A new challenge awaits!",modeDesc:{normal:"Try the 4x4 puzzle!",hard:"Try the 5x5 puzzle!",expert:"The ultimate 6x6 challenge!",free:"Play cleared modes freely!"},copyright:"Â© 2026 Mangosoft Lab."}};function ae(){function l(){j||(_.value=Q(),j=!0)}const a=R(()=>_.value),r=R(()=>_.value==="ko");function c(u,g){const k=u.split(".");let e=$[_.value];for(const s of k)if(e&&typeof e=="object"&&s in e)e=e[s];else{e=$.en;for(const i of k)if(e&&typeof e=="object"&&i in e)e=e[i];else return u;break}return typeof e!="string"?u:g?e.replace(/\{(\w+)\}/g,(s,i)=>{var d;return((d=g[i])==null?void 0:d.toString())||`{${i}}`}):e}function f(u){return c(`difficulty.${u}`)}function y(u){const g=c(`modeDesc.${u}`);return g.startsWith("modeDesc.")?c("newChallenge"):g}return{locale:a,isKorean:r,initLocale:l,t:c,getDifficultyName:f,getModeDesc:y}}const re=M("/images/background/light_01.png"),ie=M("/images/background/light_04.png"),se=M("/images/background/light_06.png"),le=M("/images/background/light_07.png"),ce=M("/images/background/light_10.png"),ue=M("/images/background/light_18.png"),J=[{id:"easy",name:"Easy",nameKr:"ì‰¬ì›€",gridSize:3,timeLimit:null,color:"rgb(253, 122, 96)"},{id:"normal",name:"Normal",nameKr:"ë³´í†µ",gridSize:4,timeLimit:null,color:"rgb(253, 194, 96)"},{id:"hard",name:"Hard",nameKr:"ì–´ë ¤ì›€",gridSize:5,timeLimit:null,color:"rgb(253, 245, 96)"},{id:"expert",name:"Expert",nameKr:"ì „ë¬¸ê°€",gridSize:6,timeLimit:null,color:"rgb(160, 253, 96)"},{id:"free",name:"Free",nameKr:"ìžìœ ",gridSize:0,timeLimit:null,color:"rgb(96, 198, 253)"}];function X(l){return J.find(a=>a.id===l)||J[0]}const Y="1772348151432";function de(l,a,r=""){return`${r.endsWith("/")?r.slice(0,-1):r}/images/puzzles/${l}/${a}.png?v=${Y}`}const Z="puzzlepang_db",ee=1,z="gameData";let L=null;function W(){return new Promise((l,a)=>{if(L){l(L);return}const r=indexedDB.open(Z,ee);r.onerror=()=>{a(r.error)},r.onsuccess=()=>{L=r.result,l(L)},r.onupgradeneeded=c=>{const f=c.target.result;f.objectStoreNames.contains(z)||f.createObjectStore(z)}})}async function K(l){try{const a=await W();return new Promise((r,c)=>{const u=a.transaction(z,"readonly").objectStore(z).get(l);u.onerror=()=>c(u.error),u.onsuccess=()=>r(u.result??null)})}catch(a){return console.error("IndexedDB getItem error:",a),null}}async function b(l,a){try{const r=await W();return new Promise((c,f)=>{const g=r.transaction(z,"readwrite").objectStore(z).put(a,l);g.onerror=()=>f(g.error),g.onsuccess=()=>c()})}catch(r){console.error("IndexedDB setItem error:",r)}}async function te(){if(typeof window>"u")return;const l="puzzlepang_migrated_to_indexeddb";if(!await K(l))try{const r=localStorage.getItem("slidingPuzzle_progress_v2");r&&await b("gameProgress",JSON.parse(r));const c=localStorage.getItem("puzzlepang-unlocked-modes");c&&await b("unlockedModes",JSON.parse(c));const f=localStorage.getItem("puzzlepang-unlock-seen");f&&await b("unlockSeen",JSON.parse(f)),localStorage.getItem("puzzlepang-tutorial-seen")&&await b("tutorialSeen",!0),await b(l,!0),console.log("Migration from localStorage to IndexedDB completed")}catch(r){console.error("Migration failed:",r)}}const T={currentStage:1,stages:{}},E={difficulties:{easy:{...T},normal:{...T},hard:{...T},expert:{...T},free:{...T}},soundEnabled:!0},p=D(JSON.parse(JSON.stringify(E)));let B=!1,I=null;function fe(){async function l(){if(B||typeof window>"u")return;await te();const e=await K("gameProgress");e&&(p.value={...JSON.parse(JSON.stringify(E)),...e,difficulties:{...JSON.parse(JSON.stringify(E.difficulties)),...e.difficulties}}),B=!0}async function a(){typeof window>"u"||(I&&clearTimeout(I),I=setTimeout(async()=>{try{const e=JSON.parse(JSON.stringify(p.value));await b("gameProgress",e)}catch(e){console.error("Failed to save progress:",e)}},100))}function r(e){const s=p.value.difficulties[e]||{...T},i=Object.values(s.stages).filter(m=>m.cleared).length;return{currentStage:s.currentStage,cleared:i,stages:s.stages}}function c(e,s){var i;return((i=p.value.difficulties[e])==null?void 0:i.stages[s])||null}function f(e,s){var i,d;return((d=(i=p.value.difficulties[e])==null?void 0:i.stages[s])==null?void 0:d.cleared)||!1}function y(e,s,i,d,m){p.value.difficulties[e]||(p.value.difficulties[e]={...T});const S=p.value.difficulties[e],o=S.stages[s],n=u(e,i,d,m),t=!o||i<o.bestTime||d<o.bestMoves;return S.stages[s]={cleared:!0,stars:o?Math.max(o.stars,n):n,bestTime:o?Math.min(o.bestTime,i):i,bestMoves:o?Math.min(o.bestMoves,d):d},S.currentStage=Math.max(S.currentStage,s+1),a(),{stars:n,isNewRecord:t}}function u(e,s,i,d){let m=3;d>=5&&(m=Math.min(m,2));const o=X(e).gridSize,n=o*o*3;return i>n*4?m=Math.min(m,1):i>n*2.5&&(m=Math.min(m,2)),m}function g(){let e=0;for(const s of Object.values(p.value.difficulties))for(const i of Object.values(s.stages))e+=i.stars||0;return e}async function k(){p.value=JSON.parse(JSON.stringify(E));const e=JSON.parse(JSON.stringify(p.value));await b("gameProgress",e)}return G(p,a,{deep:!0}),{progress:p,initProgress:l,getDifficultyProgress:r,getStageProgress:c,isStageCleared:f,clearStage:y,getTotalStars:g,resetProgress:k}}const v={move:null,clear:null,hint:null,reload:null,go:null},h={intro:null,game:null,list:null};let F=!1,P=null,C="",H=!1;const w=D(!1);let O=null;function ne(){if(typeof window>"u")return null;if(!O)try{O=new(window.AudioContext||window.webkitAudioContext)}catch(l){return console.warn("Failed to create AudioContext:",l),null}return O.state==="suspended"&&O.resume(),O}function ge(){function l(){if(!(F||typeof window>"u"))try{C=V().app.baseURL||"";const n=C.endsWith("/")?C.slice(0,-1):C;v.move=new Audio(`${n}/sounds/move.mp3`),v.clear=new Audio(`${n}/sounds/clear.mp3`),v.hint=new Audio(`${n}/sounds/hint.mp3`),v.reload=new Audio(`${n}/sounds/reload.mp3`),v.go=new Audio(`${n}/sounds/go.mp3`),Object.values(v).forEach(t=>{t&&(t.volume=.5,t.preload="auto",t.load())}),h.intro=new Audio(`${n}/sounds/intro.mp3`),h.game=new Audio(`${n}/sounds/bgm.mp3`),h.list=new Audio(`${n}/sounds/list.mp3`),Object.values(h).forEach(t=>{t&&(t.volume=.3,t.loop=!0,t.preload="auto",t.load())}),H||(document.addEventListener("visibilitychange",()=>{if(document.hidden)Object.values(h).forEach(t=>{t&&!t.paused&&t.pause()});else if(P&&!w.value){const t=h[P];t&&t.play().catch(()=>{})}}),window.addEventListener("pagehide",()=>{Object.values(h).forEach(t=>{t&&(t.pause(),t.currentTime=0)})}),H=!0),F=!0}catch(o){console.warn("Failed to load sounds:",o)}}function a(o){if(w.value)return;const n=v[o];if(n){const t=n.cloneNode();t.volume=n.volume,t.play().catch(()=>{})}}function r(){a("move")}function c(){a("clear")}function f(){a("hint")}function y(){a("reload")}function u(o=800,n=200){if(!w.value)try{const t=ne();if(!t)return;const N=t.createOscillator(),A=t.createGain();N.connect(A),A.connect(t.destination),N.frequency.value=o,N.type="sine";const x=t.currentTime,U=.01,q=.05;A.gain.setValueAtTime(0,x),A.gain.linearRampToValueAtTime(.3,x+U),A.gain.setValueAtTime(.3,x+n/1e3-q),A.gain.linearRampToValueAtTime(0,x+n/1e3),N.start(x),N.stop(x+n/1e3)}catch(t){console.warn("Failed to play beep:",t)}}function g(){a("go")}function k(){return w.value=!w.value,w.value}function e(o){w.value=o,Object.values(h).forEach(n=>{n&&(n.muted=o)})}function s(o){if(w.value)return;i();const n=h[o];n&&(n.currentTime=0,n.play().catch(()=>{}),P=o)}function i(){Object.values(h).forEach(o=>{o&&(o.pause(),o.currentTime=0)}),P=null}function d(){s("intro")}function m(){s("game")}function S(){s("list")}return{isMuted:w,loadSounds:l,play:a,playMove:r,playClear:c,playHint:f,playReload:y,playBeep:u,playGo:g,toggleMute:k,setMuted:e,playBgm:s,stopBgm:i,playIntroBgm:d,playGameBgm:m,playListBgm:S}}export{re as _,ie as a,se as b,le as c,ce as d,ue as e,ge as f,K as g,ae as h,J as i,X as j,de as k,b as s,fe as u};
